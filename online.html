<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoveDeck Online üíå - –ò–≥—Ä–∞ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏</title>
    <link rel="stylesheet" href="online.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="online-container">
        <!-- ... —Ç–≤–æ–π HTML –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ... -->
    </div>

    <!-- Firebase –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (–≤–µ—Ä—Å–∏—è 9.x) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- –ù–∞—à–∏ —Å–∫—Ä–∏–ø—Ç—ã -->
    <script src="online.js"></script>                     <!-- –õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º -->
    <script src="firebase-mode.js"></script>             <!-- Firebase —Ä–µ–∂–∏–º (—Å —Ç–≤–æ–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π) -->
    
    <script>
        // –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
        window.addEventListener('load', function() {
            console.log('üì¶ –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤ –≤—Ä—É—á–Ω—É—é
            addSimpleModeSelector();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ Enter –¥–ª—è —á–∞—Ç–∞
            const chatInput = document.getElementById('chat-input');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –≤—ã–∑—ã–≤–∞—Ç—å
                        if (window.currentMode === 'firebase' && window.firebaseSendChatMessage) {
                            window.firebaseSendChatMessage();
                        } else if (window.sendChatMessage) {
                            window.sendChatMessage();
                        }
                    }
                });
            }
        });
        
        // –ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ä–µ–∂–∏–º–æ–≤
        function addSimpleModeSelector() {
            const connectionScreen = document.getElementById('connection-screen');
            if (!connectionScreen) return;
            
            const selectorHTML = `
                <div class="simple-mode-selector">
                    <h3>üåê –†–µ–∂–∏–º –∏–≥—Ä—ã:</h3>
                    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                        <button onclick="switchToFirebaseMode()" style="
                            flex: 1;
                            padding: 15px;
                            background: linear-gradient(45deg, #FF9800, #FFB74D);
                            color: white;
                            border: none;
                            border-radius: 10px;
                            cursor: pointer;
                            font-weight: bold;
                            font-size: 16px;
                        ">
                            üî• –û–Ω–ª–∞–π–Ω (Firebase)
                            <div style="font-size: 12px; opacity: 0.9;">–ú–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏</div>
                        </button>
                        
                        <button onclick="switchToLocalMode()" style="
                            flex: 1;
                            padding: 15px;
                            background: linear-gradient(45deg, #9C27B0, #E91E63);
                            color: white;
                            border: none;
                            border-radius: 10px;
                            cursor: pointer;
                            font-weight: bold;
                            font-size: 16px;
                        ">
                            üíª –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
                            <div style="font-size: 12px; opacity: 0.9;">–ù–∞ –æ–¥–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ</div>
                        </button>
                    </div>
                    <p id="mode-info" style="
                        color: #666;
                        font-size: 14px;
                        padding: 10px;
                        background: #f9f9f9;
                        border-radius: 8px;
                        text-align: center;
                    ">
                        üî• <strong>–û–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º</strong>: –¥–ª—è –∏–≥—Ä—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏. –ù—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.
                    </p>
                </div>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏
            const style = document.createElement('style');
            style.textContent = `
                .simple-mode-selector {
                    background: white;
                    border-radius: 15px;
                    padding: 20px;
                    margin-bottom: 25px;
                    box-shadow: 0 5px 20px rgba(0,0,0,0.1);
                    border: 2px solid #e0e0e0;
                }
                .simple-mode-selector h3 {
                    color: #673ab7;
                    margin: 0 0 15px 0;
                    text-align: center;
                    font-size: 20px;
                }
            `;
            document.head.appendChild(style);
            
            // –í—Å—Ç–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å
            connectionScreen.insertAdjacentHTML('afterbegin', selectorHTML);
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ Firebase —Ä–µ–∂–∏–º
        function switchToFirebaseMode() {
            window.currentMode = 'firebase';
            document.getElementById('mode-info').innerHTML = 
                'üî• <strong>–û–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º (Firebase)</strong>: –¥–ª—è –∏–≥—Ä—ã –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏. –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–Ω–∞—Ç—É –∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–¥–æ–º.';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            updateButtonsForFirebase();
            
            alert('–í—ã–±—Ä–∞–Ω –æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–æ–º–Ω–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤–∏–¥–Ω—ã –Ω–∞ –¥—Ä—É–≥–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.');
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º
        function switchToLocalMode() {
            window.currentMode = 'local';
            document.getElementById('mode-info').innerHTML = 
                'üíª <strong>–õ–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º</strong>: –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –æ–¥–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ. –û—Ç–∫—Ä–æ–π—Ç–µ –¥–≤–µ –≤–∫–ª–∞–¥–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞.';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏
            updateButtonsForLocal();
            
            alert('–í—ã–±—Ä–∞–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º! –û—Ç–∫—Ä–æ–π—Ç–µ –¥–≤–µ –≤–∫–ª–∞–¥–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.');
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è Firebase —Ä–µ–∂–∏–º–∞
        function updateButtonsForFirebase() {
            const createBtn = document.querySelector('.player-card.create-room .btn-primary');
            const joinBtn = document.querySelector('.player-card.join-room .btn-secondary');
            const quickBtn = document.querySelector('.btn-quick-start');
            
            if (createBtn && window.firebaseCreateRoom) {
                createBtn.textContent = 'üî• –°–æ–∑–¥–∞—Ç—å –æ–Ω–ª–∞–π–Ω-–∫–æ–º–Ω–∞—Ç—É';
                createBtn.onclick = window.firebaseCreateRoom;
            }
            
            if (joinBtn && window.firebaseJoinRoom) {
                joinBtn.textContent = 'üî• –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –æ–Ω–ª–∞–π–Ω';
                joinBtn.onclick = window.firebaseJoinRoom;
            }
            
            if (quickBtn) {
                quickBtn.textContent = '‚ö° –ë—ã—Å—Ç—Ä—ã–π –æ–Ω–ª–∞–π–Ω-—Å—Ç–∞—Ä—Ç';
                quickBtn.onclick = window.firebaseCreateRoom;
            }
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        function updateButtonsForLocal() {
            const createBtn = document.querySelector('.player-card.create-room .btn-primary');
            const joinBtn = document.querySelector('.player-card.join-room .btn-secondary');
            const quickBtn = document.querySelector('.btn-quick-start');
            
            if (createBtn && window.createRoom) {
                createBtn.textContent = 'üíª –°–æ–∑–¥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –∫–æ–º–Ω–∞—Ç—É';
                createBtn.onclick = window.createRoom;
            }
            
            if (joinBtn && window.joinRoom) {
                joinBtn.textContent = 'üíª –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –ª–æ–∫–∞–ª—å–Ω–æ';
                joinBtn.onclick = window.joinRoom;
            }
            
            if (quickBtn && window.quickStartGame) {
                quickBtn.textContent = '‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç';
                quickBtn.onclick = window.quickStartGame;
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        window.currentMode = 'local';
        setTimeout(() => {
            updateButtonsForLocal();
        }, 100);
    </script>
</body>
</html>
