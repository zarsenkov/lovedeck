const CardsBank = {
    romance: {
        questions: [
            "[Имя1], какой момент в отношениях был самым романтичным?",
            "[Имя2], если бы наша любовь была фильмом, то в каком жанре?",
            "Что [Имя1] больше всего ценит в [Имя2_кому] прямо сейчас?",
            "Какую песню вы бы назвали 'вашей' и почему?",
            "[Имя1], опиши свои чувства тремя прилагательными.",
            "Какое первое качество вы заметили друг в друге при встрече?",
            "Самое доброе воспоминание о вашем первом свидании?",
            "Кто из вас более нежный и в чем это проявляется?",
            "О каком совместном путешествии мечтает [Имя1]?",
            "Что бы вы хотели делать вместе через 10 лет?",
            "Какая мелочь в поведении [Имя2] заставляет [Имя1] улыбаться?",
            "В чем секрет вашей пары, по мнению [Имя2]?",
            "Если бы вы могли пережить один день из прошлого снова, какой бы это был?",
            "[Имя1], назови черту характера [Имя2_кому], которой ты восхищаешься.",
            "Какое место вы считаете 'вашим особенным'?",
            "Что заставило тебя понять, что это любовь?",
            "[Имя2], каким ты видишь наше будущее через 5 лет?",
            "Какой самый трогательный подарок ты получил(а) от [Имя2_кому]?",
            "В какой момент ты понял(а), что хочешь быть с [Имя1_кому] навсегда?",
            "Что бы ты написал(а) в письме любви для [Имя2_кому]?",
            "Какая традиция только вашей пары самая милая?",
            "Опиши идеальный день вместе от рассвета до заката",
            "Какое твое самое нежное воспоминание о [Имя1_кому]?",
            "Что делает нашу пару особенной, по твоему мнению?",
            "[Имя1], как бы ты признался(лась) в любви [Имя2_кому] сейчас?",
            "Какой комплимент ты всегда хотел(а) услышать от [Имя2_кому]?",
            "В чем ты чувствуешь поддержку от [Имя1_кому]?",
            "Какой момент с [Имя2_кому] ты бы хотел(а) заморозить навсегда?",
            "Что в отношениях с [Имя1_кому] делает тебя счастливее всего?",
            "Какую мечту вы хотите осуществить вместе?",
            "Опиши [Имя2_кому] тремя метафорами",
            "Какие слова лучше всего описывают ваши отношения?",
            "Что ты больше всего ценишь в том, как [Имя1] проявляет любовь?",
            "Если бы вы были героями сказки, кем бы вы были?",
            "Какой совет об отношениях вы бы дали себе год назад?"
        ],
        actions: [
            "Поцелуй [Имя1_кому] в щечку 5 раз",
            "[Имя2], прошепчи на ушко [Имя1_кому] самое нежное признание",
            "Смотрите друг другу в глаза 1 минуту, не отрываясь",
            "Сделайте милое селфи прямо сейчас и сохраните его",
            "Обнимите друг друга максимально крепко в течение 30 секунд",
            "Скажи 5 комплиментов [Имя1_кому], держа за руки",
            "Пусть [Имя2] сделает легкий массаж шеи для [Имя1_кому]",
            "Танцуйте медленный танец без музыки",
            "Напиши сообщение [Имя1_кому] с текстом 'Я тебя люблю' прямо сейчас",
            "Поцелуй каждый палец на руке [Имя2_кому] по очереди",
            "Расскажи [Имя1_кому], за что ты благодарен(на) судьбе",
            "Обнимитесь и постойте так, слушая сердцебиение друг друга",
            "Нарисуй сердце на ладони [Имя2_кому] пальцем",
            "Прошепчи [Имя1_кому] три причины, почему ты его/её любишь",
            "Поцелуй [Имя2_кому] в лоб нежно и медленно",
            "Скажи [Имя1_кому], что видишь в вашем будущем вместе",
            "Возьмите друг друга за руки и помолчите минуту, просто наслаждаясь моментом",
            "Обними [Имя2_кому] сзади и скажи что-то приятное",
            "Поцелуй [Имя1_кому] в то место, которое тебе нравится больше всего",
            "Скажи [Имя2_кому] комплимент на ушко",
            "Погладь [Имя1_кому] по волосам и скажи, какой(ая) он/она красивый(ая)",
            "Сделай [Имя2_кому] массаж рук в течение 2 минут",
            "Расскажи [Имя1_кому] о своей самой романтичной фантазии с ним/ней",
            "Поцелуй [Имя2_кому] в уголок губ очень медленно",
            "Положи голову на плечо [Имя1_кому] и расскажи о своих чувствах"
        ]
    },
    fun: {
        questions: [
            "Кто из вас чаще теряет ключи или телефон?",
            "Какое самое нелепое первое впечатление было у [Имя1]?",
            "Кто из вас дольше собирается, если нужно выйти через 5 минут?",
            "Если бы вы были героями мультфильма, то кем именно?",
            "Самая странная привычка [Имя1] по мнению [Имя2_кому]?",
            "Кто из вас лучше справится с выживанием на необитаемом острове?",
            "Кто чаще начинает споры из-за того, что выбрать на ужин?",
            "Самый странный подарок, который вы дарили или получали?",
            "Кто из вас лучше танцует в ванной?",
            "Какое прозвище вы бы дали друг другу, если бы были супергероями?",
            "Кто из вас больший фанат откладывать будильник по утрам?",
            "Какой самый безумный план вы воплотили вместе?",
            "Кто из вас чаще говорит 'давай закажем еду'?",
            "Самая смешная фотография [Имя2], которую видел(а) [Имя1]?",
            "Кто из вас больше любит драму в сериалах?",
            "Какое животное напоминает [Имя1] по характеру?",
            "Кто из вас быстрее сдастся в споре ради мира?",
            "Самая забавная ситуация, в которую вы попали вместе?",
            "Кто из вас лучше врет, когда надо?",
            "Какую глупость вы сделали ради друг друга?",
            "Кто из вас чаще смеется над своими же шутками?",
            "Какой твой самый странный талант?",
            "Кто из вас более неуклюжий?",
            "Что самое смешное [Имя2] говорил(а) во сне?",
            "Кто из вас быстрее испугается в фильме ужасов?",
            "Какую песню [Имя1] поет хуже всего?",
            "Кто из вас лучше притворяется, что не виноват?",
            "Самый нелепый аргумент, из-за которого вы спорили?",
            "Кто из вас больше ребенок в душе?",
            "Какое самое странное блюдо приготовил(а) [Имя2]?",
            "Кто из вас чаще забывает, о чем говорили 5 минут назад?",
            "Какой мультфильм лучше всего описывает вашу пару?",
            "Кто из вас более драматичен в обычных ситуациях?",
            "Какую фразу [Имя1] говорит чаще всего?",
            "Кто из вас лучше сделает вид, что знает, о чем речь?"
        ],
        actions: [
            "Изобрази походку [Имя2], когда он/она злится",
            "Пусть [Имя1] споет припев песни детским голосом",
            "Поменяйтесь ролями: [Имя1] играет [Имя2_кому], а [Имя2] — [Имя1_кому]",
            "Расскажи самую несмешную шутку так, чтобы [Имя1] засмеялся",
            "Сделай 5 смешных гримас, пока [Имя2] пытается не засмеяться",
            "Попробуй рассмешить [Имя1] любыми способами без звука",
            "Прочитай любой текст из телефона как пафосный актер",
            "Изобрази, как [Имя2] ведет себя утром без кофе",
            "Спой романтичную песню максимально неромантичным голосом",
            "Сделай комплимент [Имя1_кому] голосом робота",
            "Расскажи историю знакомства, но врите в каждом предложении",
            "Попробуй говорить 1 минуту без буквы 'а'",
            "[Имя1] должен(на) рассказать анекдот максимально серьезно",
            "Изобрази [Имя2_кому], когда он/она флиртует",
            "Сделай селфи с самым глупым выражением лица",
            "Говори 30 секунд максимально быстро обо всем подряд",
            "Станцуй танец победы после обычного действия",
            "[Имя2] должен(на) изобразить 3 разных эмоции за 10 секунд",
            "Придумайте друг другу смешные прозвища прямо сейчас",
            "Повтори фразу '[Имя1], ты самый(ая) лучший(ая)' 5 раз разными голосами",
            "Изобрази своего любимого героя фильма",
            "Покажи, как ты танцуешь, когда никто не видит",
            "Расскажи про свой день голосом диктора новостей",
            "Попробуй съесть что-то с закрытыми глазами, пока [Имя1] описывает вкус",
            "Придумай рэп про вашу пару и исполни его"
        ]
    },
    adult: {
        questions: [
            "Какое твое самое смелое желание, которое мы еще не реализовали?",
            "Где бы ты хотел(а) заняться этим, кроме кровати?",
            "Какая часть тела [Имя2] заводит тебя мгновенно?",
            "Твое любимое воспоминание о 'той самой' ночи?",
            "Что бы ты хотел(а) попробовать в постели, но стеснялся(ась) сказать?",
            "Твой любимый вид поцелуя и где именно?",
            "Насколько ты оцениваешь свою страсть сегодня по шкале от 1 до 10?",
            "Какое белье на [Имя2_кому] тебе нравится больше всего?",
            "Что тебя больше всего заводит в [Имя1_кому]?",
            "Какую фантазию ты хочешь воплотить с [Имя2_кому]?",
            "Где самое необычное место, где ты хотел(а) бы этим заняться?",
            "Какое прикосновение [Имя1] сводит тебя с ума?",
            "Что ты думаешь о ролевых играх в постели?",
            "Какой у тебя любимый момент во время близости с [Имя2_кому]?",
            "Что возбуждает тебя, но ты никогда не говорил(а) об этом?",
            "Какую музыку ты бы включил(а) для романтического вечера?",
            "Что [Имя1] делает в постели, что тебе особенно нравится?",
            "Какое твое самое откровенное желание прямо сейчас?",
            "В какое время суток ты чувствуешь наибольшее желание?",
            "Что бы ты хотел(а) услышать от [Имя2_кому] во время близости?",
            "Какой аромат или запах заводит тебя больше всего?",
            "Что тебе нравится больше: нежность или страсть?",
            "Какую роль ты бы хотел(а) попробовать в ролевой игре?",
            "Что в [Имя1_кому] кажется тебе самым сексуальным?",
            "Какая обстановка делает тебя наиболее раскрепощенным(ой)?",
            "Что бы ты хотел(а), чтобы [Имя2] делал(а) чаще?",
            "Какое прикосновение заставляет тебя потерять контроль?",
            "О чем ты думаешь, когда фантазируешь о [Имя1_кому]?",
            "Какой комплимент в постели тебе хотелось бы услышать?",
            "Что делает нашу близость особенной для тебя?"
        ],
        actions: [
            "Сделай очень медленный массаж плеч [Имя2_кому]",
            "Страстный поцелуй в течение 20 секунд",
            "Поцелуй [Имя1_кому] в самую чувствительную точку на шее",
            "Пусть [Имя2] уберет один любой элемент одежды с себя",
            "Медленно расстегни что-то на [Имя1_кому] одними губами",
            "Прошепчи [Имя2_кому] свое самое грязное желание",
            "Целуй [Имя1_кому] только там, где он/она укажет в течение минуты",
            "Сделай чувственный массаж спины [Имя2_кому] в течение 3 минут",
            "Поцелуй [Имя1_кому] везде, кроме губ в течение 30 секунд",
            "Прошепчи [Имя2_кому], что бы ты хотел(а) сделать прямо сейчас",
            "Медленно проведи пальцем по губам [Имя1_кому]",
            "Укуси [Имя2_кому] губу во время поцелуя",
            "Погладь [Имя1_кому] по телу с закрытыми глазами",
            "Поцелуй [Имя2_кому] в ухо и скажи что-то возбуждающее",
            "Сделай массаж бедер [Имя1_кому] в течение минуты",
            "Посмотри [Имя2_кому] в глаза страстным взглядом 30 секунд",
            "Медленно расстегни пуговицы на одежде [Имя1_кому]",
            "Проведи языком по шее [Имя2_кому]",
            "Прижми [Имя1_кому] к стене и поцелуй страстно",
            "Скажи [Имя2_кому], что ты хочешь сделать сегодня вечером",
            "Поцелуй [Имя1_кому] везде, куда дотянешься, 1 минуту",
            "Медленно сними один элемент одежды с [Имя2_кому]",
            "Шепни [Имя1_кому] на ушко свою самую смелую фантазию",
            "Поцелуй [Имя2_кому] в те места, которые он/она обычно скрывает",
            "Сделай [Имя1_кому] массаж ног с поцелуями"
        ]
    },
    dates: {
        questions: [
            "Опиши идеальное свидание, если наш бюджет — 0 рублей",
            "Куда бы вы улетели завтра, если бы билеты были бесплатными?",
            "Свидание на крыше или пикник в лесу?",
            "Лучшее место в нашем городе для долгих поцелуев?",
            "Какой ресторан или кафе мы обязательно должны посетить?",
            "Если бы мы могли пойти на двойное свидание с любой звездной парой, кто бы это был?",
            "Какое активное свидание ты бы хотел(а) попробовать?",
            "Куда бы ты хотел(а) поехать на выходные вместе?",
            "Какой вид отдыха тебе нравится больше: море или горы?",
            "Идеальное время суток для свидания?",
            "Что бы ты выбрал(а): музей или парк развлечений?",
            "Какое свидание запомнилось тебе больше всего?",
            "Где бы ты хотел(а) встретить рассвет с [Имя1_кому]?",
            "Какой сезон года лучше всего подходит для наших свиданий?",
            "Романтический ужин дома или в ресторане?",
            "Какое место в городе напоминает тебе о нас?",
            "Куда бы ты повел(ла) [Имя2_кому] на первое свидание сейчас?",
            "Какую страну мы должны посетить вместе в первую очередь?",
            "Что важнее на свидании: атмосфера или еда?",
            "Какое приключение ты хочешь пережить с [Имя1_кому]?",
            "Идеальное зимнее свидание для вас — это?",
            "Какой фестиваль или событие ты хочешь посетить вместе?",
            "Пляжный отдых или экскурсионный тур?",
            "Какое романтичное место ты хочешь показать [Имя2_кому]?",
            "Где бы вы хотели отметить важную дату?",
            "Свидание в тишине природы или в шумном городе?",
            "Какой вид транспорта выбрать для романтической поездки?",
            "Куда бы ты хотел(а) сбежать с [Имя1_кому] прямо сейчас?",
            "Какое хобби вы хотите попробовать вместе?",
            "Идеальный план на годовщину отношений?"
        ],
        actions: [
            "Забронируйте или запланируйте поход в кино/театр прямо сейчас",
            "Выбери место для нашего следующего завтрака вне дома",
            "Найди 3 бесплатных мероприятия в городе на эти выходные",
            "Составьте список из 5 мест, где вы еще не были вдвоем",
            "Выберите вместе фильм для просмотра на следующем свидании",
            "Найдите новое кафе или ресторан, который хотите попробовать",
            "Запланируйте пикник на природе на ближайшие выходные",
            "Найдите мастер-класс для двоих в вашем городе",
            "Выберите город для поездки на выходные",
            "Составьте плейлист для романтического ужина",
            "Найдите романтичное место для фотосессии",
            "Спланируйте маршрут для вечерней прогулки",
            "Выберите активность на свежем воздухе на выходные",
            "Найдите интересную выставку или музей для посещения",
            "Запланируйте домашнее свидание с готовкой вместе",
            "Найдите необычное место для следующего свидания",
            "Составьте bucket list мест, которые хотите посетить вместе",
            "Выберите тему для следующего тематического свидания",
            "Найдите spa или массажный салон для парного посещения",
            "Запланируйте поездку на природу на целый день"
        ],
        places: [
            "Уютная кофейня на крыше с видом на закат",
            "Парк, где можно покормить уток или лебедей",
            "Старый книжный магазин с запахом кофе",
            "Пикник у реки с пледом и фруктами",
            "Ночная прогулка под звездами с термосом чая",
            "Мастер-класс по лепке из глины для двоих",
            "Вечер в антикафе за настольными играми",
            "Поход в планетарий",
            "Боулинг или караоке-баттл",
            "Романтический ужин при свечах дома",
            "Прогулка по набережной на закате",
            "Посещение ботанического сада",
            "Катание на лодке или катамаране",
            "Поход в океанариум или зоопарк",
            "Фотосессия в красивых локациях города",
            "Вечер в джаз-клубе или на концерте",
            "Поездка за город на велосипедах",
            "Посещение смотровой площадки города",
            "Романтический завтрак в постель",
            "Поход в кино на премьеру фильма",
            "Прогулка по старому городу",
            "Посещение винодельни или дегустация",
            "Катание на коньках зимой",
            "Пикник на пляже летом",
            "Поход в горы с ночевкой в палатке",
            "Спа-день для двоих",
            "Кулинарный мастер-класс",
            "Квест-комната для пары",
            "Романтическая поездка на поезде",
            "Вечер поэзии или stand-up шоу",
            "Посещение арт-галереи",
            "Пляжный пикник с костром",
            "Катание на лошадях в лесу",
            "Посещение аквапарка",
            "Ужин в ресторане с живой музыкой",
            "Прогулка по историческим местам",
            "Романтический круиз по реке",
            "Посещение фестиваля еды",
            "Ночь в необычном отеле (на дереве, иглу)",
            "Поход на фермерский рынок за продуктами для ужина вместе"
        ]
    }
};

window.usedCards = new Set();

function getRandomCard(theme) {
    let customs = JSON.parse(localStorage.getItem('lc_customs') || '[]');
    let themeCustoms = customs.filter(c => c.category === theme);
    
    if (themeCustoms.length > 0 && Math.random() < 0.2) {
        return themeCustoms[Math.floor(Math.random() * themeCustoms.length)];
    }

    let pool = [];
    if (theme === 'dates') {
        pool = [...CardsBank.dates.questions, ...CardsBank.dates.actions, ...CardsBank.dates.places];
    } else {
        pool = [...CardsBank[theme].questions, ...CardsBank[theme].actions];
    }

    let available = pool.filter(c => !window.usedCards.has(c));
    if (available.length === 0) { 
        window.usedCards.clear(); 
        available = pool; 
    }

    let raw = available[Math.floor(Math.random() * available.length)];
    let type = 'задание';
    let tip = '';

    if (CardsBank[theme].questions?.includes(raw)) type = 'вопрос';
    if (theme === 'dates' && CardsBank.dates.places.includes(raw)) {
        type = 'место';
        tip = 'Идея для вашего следующего выхода!';
    } else if (CardsBank[theme].actions?.includes(raw)) {
        type = 'действие';
    }

    return { text: raw, type: type, tip: tip };
}